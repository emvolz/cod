<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Inference of Coalescent ODds in Phylogenetic Trees â€¢ cod</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Inference of Coalescent ODds in Phylogenetic Trees">
<meta name="description" content="Provides models for inferring variation in coalescent rates across branches in a phylogenetic tree, identifying growing lineages, adjusting for biased sampling, computing phylogenetic clusters, optimising cluster thresholds, &amp; summarising variation in rates.">
<meta property="og:description" content="Provides models for inferring variation in coalescent rates across branches in a phylogenetic tree, identifying growing lineages, adjusting for biased sampling, computing phylogenetic clusters, optimising cluster thresholds, &amp; summarising variation in rates.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">cod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/ngono.html">Neisseria gonorrheae: Computing coalescent odds, identifying growing lineages, cluster identification &amp; sample reweighting</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="cod-inference-of-coalescent-odds-in-phylogenetic-trees">
<code>cod</code>: Inference of Coalescent ODds in Phylogenetic Trees<a class="anchor" aria-label="anchor" href="#cod-inference-of-coalescent-odds-in-phylogenetic-trees"></a>
</h1></div>
<p><img src="reference/figures/cod.png" align="right" height="139"></p>
<p><a href="https://opensource.org/licenses/MIT" class="external-link"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a></p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>cod</code> R package provides tools for inferring variation in coalescent rates across branches in phylogenetic trees. It provides methods to identify growing lineages, adjust for biased sampling, compute phylogenetic clusters, optimize cluster thresholds, and summarize rate variations.</p>
<p>For worked examples and detailed usage, see package documentation and vigettes at <a href="https://emvolz.github.io/cod/">https://emvolz.github.io/cod/</a>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install <code>cod</code> from GitHub using <code>devtools</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"emvolz/cod"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<p>The package requires several dependencies: - Matrix (&gt;= 1.7) - ape (&gt;= 5.0) - glue (&gt;= 1.0.0) - mgcv (&gt;= 1.9-1) - parallel</p>
<p>Optional packages for visualization: - ggtree (&gt;= 3.12.0) - ggplot2 (&gt;= 3.0.0)</p>
</div>
<div class="section level2">
<h2 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h2>
<div class="section level3">
<h3 id="estimating-coalescent-odds">Estimating Coalescent Odds<a class="anchor" aria-label="anchor" href="#estimating-coalescent-odds"></a>
</h3>
<p>The main function <code><a href="reference/codls.html">codls()</a></code> estimates coalescent odds using weighted least squares:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load a phylogenetic tree</span></span>
<span><span class="va">tr</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span><span class="st">"your_tree_file.nwk"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the COD GMRF model</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/codls.html">codls</a></span><span class="op">(</span><span class="va">tr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the results (requires ggtree)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="phylogenetic-clustering">Phylogenetic Clustering<a class="anchor" aria-label="anchor" href="#phylogenetic-clustering"></a>
</h3>
<p>Identify clusters in phylogenetic trees based on coalescent odds:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find optimal clustering threshold</span></span>
<span><span class="va">chis</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/chindices.html">chindices</a></span><span class="op">(</span><span class="va">f</span>, clths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1.5</span>, length <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute clusters</span></span>
<span><span class="va">clusterdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/computeclusters.html">computeclusters</a></span><span class="op">(</span><span class="va">f</span>, clth <span class="op">=</span> <span class="va">chis</span><span class="op">$</span><span class="va">threshold</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">chis</span><span class="op">$</span><span class="va">CH</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot clusters (requires ggtree)</span></span>
<span><span class="fu"><a href="reference/plotclusters.html">plotclusters</a></span><span class="op">(</span><span class="va">f</span>, <span class="va">clusterdf</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adjusting-for-sampling-bias">Adjusting for Sampling Bias<a class="anchor" aria-label="anchor" href="#adjusting-for-sampling-bias"></a>
</h3>
<p>Correct for biased sampling using the sample reweighting method:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identify tips to reweight</span></span>
<span><span class="va">reweight_tips</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tip1"</span>, <span class="st">"tip2"</span>, <span class="st">"tip3"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Automatically determine optimal reweighting</span></span>
<span><span class="va">reweightedfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/autoreweight.html">autoreweight</a></span><span class="op">(</span><span class="va">f</span>, <span class="va">reweight_tips</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<p>For detailed documentation on functions and their parameters, use the R help system and vignettes:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">codls</span></span>
<span><span class="op">?</span><span class="va">computeclusters</span></span>
<span><span class="op">?</span><span class="va">autoreweight</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>A manuscript describing the methods in this package is currently in preparation.</p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>This package is available under the MIT License. See the LICENSE file for more information.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing cod</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Erik Volz <br><small class="roles"> Maintainer </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Erik Volz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
